<ion-header class="ion-no-border">
  <ion-toolbar color="secondary" class="header-toolbar">
    <ion-buttons slot="start">
      <ion-back-button class="back-button" (click)="goBack()"></ion-back-button>
    </ion-buttons>
    <ion-title class="header-title">Detalles del Grupo</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="detail-content">
  <div class="content-container">
    <div class="welcome-section">
      <ion-icon name="people-circle-outline" class="welcome-icon"></ion-icon>
      <h2 class="welcome-title">Miembros del Grupo</h2>

      @if (hasGroupInfo) {
      <div class="group-info-section">
        <div class="info-item">
          <ion-icon name="people" class="info-icon group-icon"></ion-icon>
          <span class="info-text group-name">{{ groupName }}</span>
        </div>
        <div class="info-item">
          <ion-icon name="location-outline" class="info-icon location-icon"></ion-icon>
          <span class="info-text location-name">{{ cityName }}</span>
        </div>
      </div>
      }


      <p class="welcome-subtitle">
        Gestiona y visualiza todos los miembros asignados a este grupo
      </p>
    </div>
    <div class="members-section">
      <div class="section-header">
        <ion-icon name="people-outline" class="section-icon"></ion-icon>
        <h3 class="section-title">Lista de Miembros</h3>
        <ion-badge class="members-count" color="secondary">
          {{ members$().length }}
        </ion-badge>
      </div>

      <div class="members-container">
        @defer(on timer(3000)){
        @for(member of members$(); track member.id){
        <div class="member-card">
          <div class="member-info">
            <div class="member-header">
              <div class="member-avatar">
                <ion-icon name="person-circle-outline" class="member-icon"></ion-icon>
              </div>
              <div class="member-details">
                <h4 class="member-name">{{ member.name }} {{ member.lastname }}</h4>
                <p class="member-identification">
                  <ion-icon name="card-outline" class="id-icon"></ion-icon>
                  {{ member.identification }}
                </p>
              </div>
            </div>
          </div>
          <div class="member-actions">
            <ion-button fill="clear" size="small" class="action-button">
              <ion-icon name="ellipsis-horizontal-outline" class="action-icon"></ion-icon>
            </ion-button>
          </div>
        </div>
        }
        }
        @placeholder{
        <div class="member-card skeleton-card">
          <div class="member-info">
            <div class="member-header">
              <div class="member-avatar">
                <ion-skeleton-text animated class="skeleton-member-icon"></ion-skeleton-text>
              </div>
              <div class="member-details">
                <ion-skeleton-text animated style="width: 80%; height: 20px; margin-bottom: 8px;"></ion-skeleton-text>
                <ion-skeleton-text animated style="width: 60%; height: 16px;"></ion-skeleton-text>
              </div>
            </div>
          </div>
          <div class="member-actions">
            <ion-skeleton-text animated style="width: 32px; height: 32px; border-radius: 50%;"></ion-skeleton-text>
          </div>
        </div>
        }
        @error {
        <div class="error-card">
          <ion-icon name="alert-circle-outline" class="error-icon"></ion-icon>
          <p class="error-text">Error al cargar los miembros. Inténtalo de nuevo más tarde.</p>
        </div>
        }
      </div>
    </div>
  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed" class="fab-container">
    <ion-fab-button color="secondary" class="add-member-fab" (click)="openFormularyModal()">
      <ion-icon name="person-add-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>